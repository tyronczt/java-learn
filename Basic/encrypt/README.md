你是Java高级架构师，要实现对Java项目的全链路安全加密，场景是前端输入身份证号进行人员信息查询，后端进行参数传递向数仓，数仓进行数据拼装，然后返回后端，后端将数据组装返回前端json串，目标是：1、全链路中不能出现明文，包含前端参数透传，后端参数透传，数仓参数透传，数据库入库为加密，开发人员也无法对密文进行解密；2、a用户查询的数据，b用户无法查询；3、审计日志中可查看到查询的身份证，4、审计日志中支持对身份证号的模糊查询功能

流程图
```mermaid
sequenceDiagram
    participant 用户
    participant 前端
    participant 后端API
    participant 密钥服务
    participant 数仓服务
    participant 数据库
    participant 审计日志
    
    用户->>前端: 输入身份证号
    
    %% 前端加密流程
    前端->>密钥服务: 请求用户公钥(userId)
    密钥服务-->>前端: 返回RSA公钥
    前端->>前端: 生成AES会话密钥
    前端->>前端: 生成随机IV
    前端->>前端: 使用RSA公钥加密会话密钥
    前端->>后端API: 发送加密会话密钥和IV
    
    %% 后端会话建立
    后端API->>密钥服务: 使用用户私钥解密会话密钥
    密钥服务-->>后端API: 返回解密后的会话密钥
    后端API->>后端API: 存储会话密钥和IV
    
    %% 身份证加密传输
    前端->>前端: 使用AES-GCM和会话密钥加密身份证号
    前端->>后端API: 发送加密身份证号和请求参数
    
    %% 后端处理(不解密)
    后端API->>后端API: 生成请求追踪ID
    后端API->>审计日志: 记录加密请求(追踪ID,userId)
    
    %% 数仓处理
    后端API->>数仓服务: 传递加密身份证号、会话密钥信息和用户标识
    数仓服务->>密钥服务: 获取授权密钥
    密钥服务-->>数仓服务: 返回授权密钥
    数仓服务->>数仓服务: 使用会话密钥解密身份证号
    数仓服务->>数仓服务: 计算身份证哈希和模糊索引
    
    %% 审计日志更新
    数仓服务->>审计日志: 更新审计记录(追踪ID,身份证哈希,模糊索引)
    
    %% 数据查询和处理
    数仓服务->>数据库: 查询加密数据(使用盲索引)
    数据库-->>数仓服务: 返回加密数据结果集
    数仓服务->>数仓服务: 数据拼装和处理
    数仓服务->>数仓服务: 使用会话密钥加密结果数据
    数仓服务-->>后端API: 返回加密结果数据
    
    %% 返回结果
    后端API-->>前端: 转发加密JSON数据
    
    %% 前端展示
    前端->>前端: 使用会话密钥解密JSON数据
    前端->>前端: 数据脱敏处理
    前端-->>用户: 展示查询结果
```